# Copyright 2013 6WIND S.A.

menu "Fast path filter"

config MCORE_NETFILTER
	bool "Filtering support"
	depends on MCORE_IP
	default y
	help
	  Enable filtering support.

config MCORE_NETFILTER_ENHANCED
	bool "Enhanced filtering"
	depends on MCORE_NETFILTER
	default y

config MCORE_NFTABLE_SEQNUM
	bool "Sequence number for table"
	depends on MCORE_NETFILTER
	default n

config MCORE_NF_MAXRULES
	int "Maximum number of rules"
	depends on MCORE_NETFILTER
	default 3072

config MCORE_NF_TABLE_PER_VR
	bool "Separate netfilter tables per VR"
	depends on MCORE_NETFILTER && MCORE_VRF
	default n

menu "Fast path conntracks"

config MCORE_NF_CT
	bool "Conntrack support"
	depends on MCORE_NETFILTER
	default y

config MCORE_NF_CT_CPEID
	bool "CPEID support"
	depends on MCORE_NF_CT
	default n

config MCORE_NF_CT_HASH_CPEID_ORDER
	int "Fast Path cpe id hash order for conntracks"
	depends on MCORE_NF_CT_CPEID
	default 10

config MCORE_NF_CT_BYTES
	bool "Bytes accounting"
	depends on MCORE_NF_CT
	default y

config MCORE_NF_CT_HASH_ORDER
	int "Hash table size order"
	depends on MCORE_NF_CT
	default 19

config MCORE_NF_CT_MAX
	int "Maximum number of conntracks"
	depends on MCORE_NF_CT
	default 524288

endmenu

menu "Cache support"

config MCORE_NETFILTER_CACHE
	bool "Filter cache support"
	depends on MCORE_NETFILTER
	default y

config MCORE_NETFILTER_CACHE_INTERMEDIATE_STATS
	bool "Intermediate stats"
	depends on MCORE_NETFILTER_CACHE
	default n

config MCORE_NF_MAX_CACHE_ORDER
	int "NF cache size order"
	default 14
	depends on MCORE_NETFILTER_CACHE

config MCORE_NF_CACHE_HASHTABLE_ORDER
	int "NF cache hash size order"
	default 14
	depends on MCORE_NETFILTER_CACHE

endmenu

endmenu
